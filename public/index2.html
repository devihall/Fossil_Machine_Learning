<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Shark Tooth Machine Learning Model</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ml5/0.7.1/ml5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
</head>
<body>
    <div class="container mt-5">
        <h1>Neural Network Image Classification</h1>
        <button onclick="trainModel()" class="btn btn-primary">Train Model</button>
        <button onclick="classify()" class="btn btn-success">Classify</button>
    </div>

    <script>
        let nn;
        const options = {
            task: 'imageClassification',
            debug: true
        };

        function setup() {
            nn = ml5.neuralNetwork(options);

            // Hardcoded image URLs
            const images = [
                { url: 'images/dataSets/sharks/galeocerdo_cuvier/VP UF-TRO8939 lingual copy.png', label: 'category1' },
                { url: 'images/dataSets/sharks/isurus_hastalis/VP UF-TRO5637 lingual copy.png', label: 'category2' },
                { url: 'images/dataSets/sharks/otodus_megalodon/VP GS1381 lingual copy.png', label: 'category1' }
            ];

            images.forEach(image => {
                loadImage(image.url, img => {
                    img.resize(50, 50); // Resize image
                    imageReady(img, image.label);
                });
            });
        }

        function imageReady(img, label) {
            nn.addData({ image: img }, { label: label });
        }

        function trainModel() {
            nn.normalizeData();
            nn.train({ epochs: 30 }, finishedTraining);
        }

        function finishedTraining() {
            console.log('Model trained!');
            classify();
        }

        function classify() {
            // Assume we classify the first image again
            loadImage('image1.jpg', img => {
                img.resize(50, 50);
                nn.classify({ image: img }, (error, results) => {
                    if (error) {
                        console.error(error);
                    } else {
                        console.log(results);
                    }
                });
            });
        }

        // Load the model and images
        window.onload = setup;
    </script>
</body>
</html>
